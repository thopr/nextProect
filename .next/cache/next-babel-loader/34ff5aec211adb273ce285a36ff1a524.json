{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport Admin_nav from \"./Admin_nav\";\nimport HeaderNav from \"./HeaderNav\";\nimport Footer from \"./Footer\";\nimport useAuth, { ProtectRoute } from \"../contexts/auth.js\";\nimport { GetCouponsByBracnhCat } from \"../services/api_get\";\nimport { useRouter } from \"next/router\";\nimport Skeleton from \"react-loading-skeleton\";\nimport { mutate } from \"swr\";\n\nconst CoubonTable = ({\n  selected,\n  reqoiredAmount,\n  Categoryid,\n  Branchid,\n  pool\n}) => {\n  const router = useRouter();\n  const {\n    user,\n    isAuthenticated,\n    loading\n  } = useAuth();\n  const {\n    0: MyRes,\n    1: setMyRes\n  } = useState([]);\n  const {\n    0: firstTime,\n    1: setfirstTime\n  } = useState(true);\n  const {\n    0: mypool,\n    1: setmypool\n  } = useState([]);\n  useEffect(() => {\n    if (!isAuthenticated && !loading) Router.push(\"/login\");\n  }, [loading, isAuthenticated]);\n  /*\r\n  useEffect(() => {\r\n    /* mutate(\r\n      \"rabwa/GetCouponsByBracnhCat?Branchid=\" +\r\n        Branchid +\r\n        \"&Categoryid=\" +\r\n        Categoryid\r\n    );*/\n\n  /*\r\n    if (JSON.stringify(pool) != JSON.stringify(mypool)) {\r\n      setmypool(pool);\r\n    }\r\n  });*/\n\n  const {\n    data,\n    isLoading,\n    isError\n  } = GetCouponsByBracnhCat(Branchid, Categoryid);\n  const results = isLoading ? false : data.data;\n  console.log(results);\n  const showSkeleton = isLoading || loading;\n\n  function checkcoubon(Section_id) {\n    let tempcheck = false;\n    let favorite = pool;\n\n    for (let index = 0; index < favorite.length; index++) {\n      const element = favorite[index];\n\n      if (element.Section_id == Section_id) {\n        tempcheck = true;\n      }\n    }\n\n    return tempcheck;\n  }\n\n  if (firstTime && results) {\n    setMyRes(results);\n    setfirstTime(false);\n  }\n\n  return __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"table-responsive\"\n  }, results ? __jsx(\"table\", {\n    className: \"table align-items-center table-flush\"\n  }, __jsx(\"thead\", {\n    className: \"thead-light\"\n  }, __jsx(\"tr\", null, __jsx(\"th\", {\n    scope: \"col\",\n    \"data-sort\": \"name\"\n  }, \"\\u0627\\u0644\\u0625\\u0633\\u0645\"), __jsx(\"th\", {\n    scope: \"col\",\n    \"data-sort\": \"status\"\n  }, \"\\u0627\\u0644\\u0646\\u0648\\u0639\"), __jsx(\"th\", {\n    scope: \"col\",\n    \"data-sort\": \"completion\"\n  }, \"\\u0627\\u0644\\u0643\\u0645\\u064A\\u0629\"), __jsx(\"th\", {\n    scope: \"col\"\n  }))), __jsx(\"tbody\", {\n    className: \"list\"\n  }, results.map((coubon, index) => {\n    return __jsx(\"tr\", null, __jsx(\"td\", {\n      className: \"name\"\n    }, __jsx(\"span\", {\n      className: \"text-lg\"\n    }, coubon.name)), __jsx(\"td\", {\n      className: \"name\"\n    }, coubon.type == \"cash\" ? __jsx(\"span\", {\n      class: \"badge badge-pill badge-lg badge-secondary\"\n    }, __jsx(\"img\", {\n      className: \"avatar avatar-sm rounded-circle\",\n      src: \"/assets/img/icons/cash.jpg\",\n      height: \"40\",\n      width: \"40\"\n    })) : coubon.type == \"basket\" ? __jsx(\"span\", {\n      class: \"badge badge-pill badge-lg badge-secondary\"\n    }, __jsx(\"img\", {\n      className: \"avatar avatar-sm rounded-circle\",\n      src: \"/assets/img/icons/basket.jpg\",\n      height: \"40\",\n      width: \"40\"\n    })) : coubon.type == \"discount\" ? __jsx(\"span\", {\n      class: \"badge badge-pill badge-lg badge-secondary\"\n    }, __jsx(\"img\", {\n      className: \"avatar avatar-sm rounded-circle\",\n      src: \"/assets/img/icons/discount.jpg\",\n      height: \"40\",\n      width: \"40\"\n    })) : \"\"), __jsx(\"td\", {\n      className: \"name\"\n    }, __jsx(\"span\", {\n      className: \"text-lg\"\n    }, coubon.amount - 1)), pool ? __jsx(\"td\", {\n      className: \"name\"\n    }, reqoiredAmount <= coubon.amount - 1 ? checkcoubon(coubon.Section_id) ? __jsx(\"button\", {\n      type: \"button\",\n      class: \"btn btn-default\",\n      onClick: () => {\n        selected(coubon.amount - 1, coubon.Section_id, coubon.name, \"remove\");\n      }\n    }, \"\\u0625\\u0644\\u063A\\u0627\\u0621\") : __jsx(\"button\", {\n      type: \"button\",\n      class: \"btn btn-default\",\n      onClick: () => {\n        selected(coubon.amount - 1, coubon.Section_id, coubon.name, \"add\");\n      }\n    }, \"\\u0625\\u0636\\u0627\\u0641\\u0629\") : __jsx(\"button\", {\n      type: \"button\",\n      class: \"btn btn-default\",\n      disabled: true\n    }, \"\\u0625\\u0636\\u0627\\u0641\\u0629\")) : \"\");\n  }))) : \"\", showSkeleton ? __jsx(Skeleton, {\n    height: 40,\n    count: 10\n  }) : \"\"));\n};\n\nexport default CoubonTable;","map":null,"metadata":{},"sourceType":"module"}