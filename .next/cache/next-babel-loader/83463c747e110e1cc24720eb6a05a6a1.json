{"ast":null,"code":"var __jsx = React.createElement;\nimport Admin_nav from \"../components/Admin_nav\";\nimport React, { useState, useEffect } from \"react\";\nimport HeaderNav from \"../components/HeaderNav\";\nimport PersonNeeds from \"../components/PersonNeeds\";\nimport api from \"../services/Api\";\nimport EditableImage from \"../Components/editable-image/EditableImage\";\nimport ButtonUploadImage from \"../Components/button-upload/ButtonUpload\";\nimport axios from \"axios\";\nimport Footer from \"../components/Footer\";\nimport { GetC } from \"../services/api_get\";\nimport useAuth, { ProtectRoute } from \"../contexts/auth.js\";\nimport { useAlert } from \"react-alert\";\nimport Cookies from \"js-cookie\";\n\nfunction Table() {\n  const token = Cookies.get(\"token\");\n  const siteUrl = Cookies.get(\"siteUrl\");\n  const {\n    0: ProductImage,\n    1: setProductImage\n  } = useState();\n  const alert = useAlert(); //const [project,setProject] = useState(false);\n\n  const {\n    toggler,\n    settoggler,\n    loading\n  } = useAuth();\n  const {\n    0: spinner,\n    1: setspinner\n  } = useState(false);\n  const {\n    data,\n    isLoading,\n    isError\n  } = GetC();\n  const results = isLoading ? false : data.data;\n  console.log(results);\n  const showSkeleton = isLoading || loading;\n  const {\n    0: firstTime,\n    1: setfirstTime\n  } = useState(true);\n  const {\n    0: categories,\n    1: setcategories\n  } = useState([]);\n  const {\n    0: registerResults,\n    1: setregisterResults\n  } = useState([]);\n\n  if (firstTime && results) {\n    setcategories(results.options.categories);\n    setfirstTime(false);\n  }\n\n  const {\n    0: XML,\n    1: setXML\n  } = useState(\"\");\n  const {\n    0: step,\n    1: setStep\n  } = useState(1);\n  const {\n    0: step2,\n    1: setStep2\n  } = useState(0);\n  const {\n    0: list,\n    1: updateList\n  } = useState([]);\n  const {\n    0: allowed,\n    1: setallowed\n  } = useState(false);\n\n  function updateArray(data) {\n    let favorite = list;\n    favorite.push(data);\n    updateList(favorite);\n    setallowed(true); //  setPersonNeeds((PersonNeeds) => PersonNeeds.concat(data));\n    // setPersonNeeds((PersonNeeds) => [...PersonNeeds, data]);\n  }\n\n  function handleThumbnailProduct(file) {\n    let imageObj = {\n      id: file.name,\n      name: file.name,\n      isUloading: true,\n      imageObject: file\n    };\n    console.log(imageObj);\n    setProductImage(imageObj);\n    let formData = new FormData();\n    formData.append(\"file\", file);\n    axios.post(siteUrl + \"wp/v2/media\", formData, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(result => {\n      console.log(result.data.source_url);\n      setXML(result.data.source_url);\n    });\n  }\n\n  async function removeUser(id) {\n    let favorite = list;\n\n    if (list.length == 1) {\n      setallowed(false);\n    }\n\n    favorite = await favorite.filter(e => e.id !== id);\n    updateList(favorite);\n  }\n\n  function mysubmit() {\n    let data = {\n      XML,\n      categories: list\n    };\n    let checke = true;\n    console.log(data);\n\n    if (data.XML == \"\") {\n      checke = false;\n      alert.show(\"الرجاء رفع الملف \", {\n        timeout: 2000,\n        type: \"error\"\n      });\n    }\n\n    if (data.categories.length == 0) {\n      checke = false;\n      alert.show(\"الرجاء إختيار إحتياج واحد أو أكثر \", {\n        timeout: 2000,\n        type: \"error\"\n      });\n    }\n\n    setspinner(true);\n\n    if (checke) {\n      api.post(\"rabwa/CreatNewUserXml\", data).then(res => {\n        setspinner(false);\n        console.log(res.data);\n\n        if (res.data == \"already exists\") {\n          alert.show(\"إسم الكوبون موجود مسبقا \", {\n            timeout: 2000,\n            type: \"error\"\n          });\n        }\n\n        if (res.data == \"phone\") {\n          alert.show(\"رقم الجوال مستخدم مسبقا\", {\n            timeout: 2000,\n            type: \"error\"\n          });\n        }\n\n        if (res.data == \"email\") {\n          alert.show(\"الإيميل مستخدم مسبقا\", {\n            timeout: 2000,\n            type: \"error\"\n          });\n        }\n\n        if (res.data.length > 0) {\n          setregisterResults(res.data);\n          setStep2(3);\n          alert.show(\"تم بنجاح\", {\n            timeout: 2000,\n            type: \"success\"\n          }); //GoBackAndTriggerMutation();\n          //router.push(\"/companys/[name]\", \"/companys/\" + formdata.companyName);\n        } //console.log(res.data);\n\n      }).catch(err => {\n        alert.show(\"حصل خطأ\", {\n          timeout: 2000,\n          type: \"error\"\n        });\n        setspinner(false);\n        console.log(err);\n      });\n    }\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"body\", {\n    className: \"rtl g-sidenav-show g-sidenav-pinned\",\n    dir: \"rtl\"\n  }, __jsx(\"div\", null, __jsx(Admin_nav, null), __jsx(\"div\", {\n    class: \"main-content\",\n    id: \"panel\"\n  }, __jsx(HeaderNav, null), __jsx(\"div\", {\n    class: \"container-fluid mt--6\"\n  }, __jsx(\"div\", {\n    class: \"row justify-content-center\"\n  }, __jsx(\"div\", {\n    class: \" col \"\n  }, __jsx(\"div\", {\n    class: \"card\"\n  }, __jsx(\"div\", {\n    class: \"card-header bg-transparent\"\n  }, __jsx(\"h3\", {\n    class: \"mb-0\"\n  }, \"\\u062A\\u0633\\u062C\\u064A\\u0644 \\u0645\\u062C\\u0645\\u0648\\u0639\\u0629 \\u0645\\u0633\\u062A\\u0641\\u064A\\u062F\\u064A\\u0646\")), __jsx(\"div\", {\n    class: \"card-body\"\n  }, step == 1 ? __jsx(\"div\", null, \" \", __jsx(\"h6\", {\n    className: \"heading-small text-muted mb-4\"\n  }, \"\\u0631\\u0641\\u0639 \\u0627\\u0644\\u0645\\u0644\\u0641\"), __jsx(\"div\", {\n    className: \"pl-lg-4\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, __jsx(\"div\", {\n    style: {\n      width: \"140px\",\n      margin: \"2em auto\"\n    }\n  }, ProductImage ? __jsx(EditableImage, {\n    imageObject: ProductImage,\n    removeImageFunc: () => setProductImage(false)\n  }) : __jsx(ButtonUploadImage, {\n    typeImage: \"thumbnail\",\n    onChange: thumbnail => handleThumbnailProduct(thumbnail.target.files[0])\n  })))))) : \"\", step == 2 ? step2 == 0 ? __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"table-responsive\"\n  }, __jsx(\"div\", null, __jsx(\"table\", {\n    className: \"table align-items-center\"\n  }, __jsx(\"thead\", {\n    className: \"thead-light\"\n  }, __jsx(\"tr\", null, __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"name\"\n  }, \"\\u0627\\u0644\\u0625\\u062D\\u062A\\u064A\\u0627\\u062C\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0627\\u062E\\u062A\\u064A\\u0627\\u0631\"))), __jsx(\"tbody\", {\n    className: \"list\"\n  }, categories.length > 0 ? categories.map((data, i) => {\n    return __jsx(PersonNeeds, {\n      data: data,\n      updateArray: updateArray,\n      removeUser: removeUser\n    });\n  }) : \"\"))))) : __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"table-responsive\"\n  }, __jsx(\"div\", null, __jsx(\"table\", {\n    className: \"table align-items-center\"\n  }, __jsx(\"thead\", {\n    className: \"thead-light\"\n  }, __jsx(\"tr\", null, __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"name\"\n  }, \"\\u0627\\u0644\\u0625\\u0633\\u0645\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0627\\u0644\\u0625\\u064A\\u0645\\u064A\\u0644\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0631\\u0642\\u0645 \\u0627\\u0644\\u062C\\u0648\\u0627\\u0644\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0627\\u0644\\u062D\\u0627\\u0644\\u0629\"))), __jsx(\"tbody\", {\n    className: \"list\"\n  }, registerResults.length > 0 ? registerResults.map((data, i) => {\n    return __jsx(\"tr\", null, __jsx(\"td\", {\n      className: \"budget\"\n    }, data.FirstName[0] + \" \" + data.LastName[0]), __jsx(\"td\", {\n      className: \"budget\"\n    }, data.Email[0]), __jsx(\"td\", {\n      className: \"budget\"\n    }, data.Phone[0]), __jsx(\"td\", {\n      className: \"budget\"\n    }, data.res == \"phone\" ? __jsx(\"p\", {\n      style: {\n        color: \"red\"\n      }\n    }, \"\\u0631\\u0642\\u0645 \\u0627\\u0644\\u062C\\u0648\\u0627\\u0644 \\u0645\\u0633\\u062A\\u062E\\u062F\\u0645 \\u0645\\u0633\\u0628\\u0642\\u0627\") : data.res == \"email\" ? __jsx(\"p\", {\n      style: {\n        color: \"red\"\n      }\n    }, \"\\u0627\\u0644\\u0625\\u064A\\u0645\\u064A\\u0644 \\u0645\\u0633\\u062A\\u062E\\u062F\\u0645 \\u0645\\u0633\\u0628\\u0642\\u0627\", \" \") : data.res ? __jsx(\"p\", {\n      style: {\n        color: \"green\"\n      }\n    }, \"\\u062A\\u0645 \\u0628\\u0646\\u062C\\u0627\\u062D\", \" \") : \"\"));\n  }) : \"\"))))) : \"\", __jsx(\"div\", null, __jsx(\"div\", {\n    style: {\n      margin: \"0 auto\",\n      textAlign: \"center\",\n      marginTop: \"9em\"\n    }\n  }, step == 1 ? \"\" : step2 == 0 ? __jsx(\"button\", {\n    type: \"button\",\n    class: \"btn btn-lg btn-primary\",\n    disabled: step == 1 ? true : false,\n    onClick: () => {\n      step == 1 ? false : setStep(step - 1);\n    }\n  }, \"\\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\") : \"\", \"     \", step == 2 ? \"\" : __jsx(\"button\", {\n    type: \"button\",\n    class: \"btn btn-lg btn-primary\",\n    disabled: step == 2 ? true : false,\n    onClick: () => {\n      step == 2 ? false : setStep(step + 1);\n    }\n  }, \"\\u0627\\u0644\\u062A\\u0627\\u0644\\u064A\"))), step == 2 ? step2 == 0 ? __jsx(\"div\", null, __jsx(\"hr\", null), __jsx(\"div\", {\n    style: {\n      textAlign: \"left\"\n    }\n  }, __jsx(\"button\", {\n    class: \"btn btn-icon btn-success\",\n    onClick: () => {\n      mysubmit();\n    },\n    type: \"button\"\n  }, __jsx(\"span\", {\n    style: {\n      marginLeft: \".75em\",\n      marginRight: \"auto\"\n    },\n    class: \"btn-inner--text\"\n  }, \"\\u0625\\u0646\\u0634\\u0627\\u0621\"), \"     \", __jsx(\"span\", {\n    class: \"btn-inner--icon\"\n  }, __jsx(\"i\", {\n    class: \"ni ni-send\"\n  }))))) : \"\" : \"\")))), __jsx(Footer, null))))));\n}\n\nexport default ProtectRoute(Table);","map":null,"metadata":{},"sourceType":"module"}