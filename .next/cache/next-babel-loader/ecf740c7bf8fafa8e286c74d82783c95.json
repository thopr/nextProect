{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport Admin_nav from \"../../../components/Admin_nav\";\nimport HeaderNav from \"../../../components/HeaderNav\";\nimport Footer from \"../../../components/Footer\";\nimport BranchCoubonTable from \"../../../components/BranchCoubonTable\";\nimport NewBranchForm from \"../../../components/NewBranchForm\";\nimport EditBranchForm from \"../../../components/EditBranchForm\";\nimport useAuth, { ProtectRoute } from \"../../../contexts/auth.js\";\nimport { getCompany } from \"../../../services/api_get\";\nimport { useRouter } from \"next/router\";\nimport Skeleton from \"react-loading-skeleton\";\nimport { mutate } from \"swr\";\n\nfunction company() {\n  const router = useRouter(); //const [currentCity, setCurrentCity] = useState(\"\");\n\n  const {\n    name\n  } = router.query;\n  const {\n    toggler,\n    settoggler,\n    loading\n  } = useAuth();\n  const {\n    data,\n    isLoading,\n    isError\n  } = getCompany(name);\n  const results = isLoading ? false : data.data;\n  const showSkeleton = isLoading || loading;\n  const {\n    0: choose,\n    1: setChoose\n  } = useState(\"branches\");\n  console.log(data);\n  const {\n    0: branch_id,\n    1: setBranch_id\n  } = useState();\n  const {\n    0: BracnhCode,\n    1: setBracnhCode\n  } = useState();\n  const {\n    0: Branch,\n    1: setBranch\n  } = useState();\n  const {\n    0: edit,\n    1: setedit\n  } = useState(false);\n  const {\n    0: newCompany,\n    1: setnewCompany\n  } = useState(false);\n\n  function changeChoose(mychosen) {\n    setChoose(mychosen);\n  }\n\n  function changenewCompany() {\n    setnewCompany(false);\n    setedit(false);\n  }\n\n  function GoBackAndTriggerMutation() {\n    mutate(\"rabwa/getCompany?name=\" + name);\n    setnewCompany(false);\n    setedit(false);\n  }\n\n  const {\n    0: Branchname,\n    1: setBranchname\n  } = useState(\"\");\n  const {\n    0: compname,\n    1: setcompname\n  } = useState(\"\");\n\n  function displayCards(results) {\n    localStorage.CurrentCity = \"\";\n    return __jsx(React.Fragment, null, __jsx(\"h2\", null, results[0].company_name), choose == \"branches\" ? __jsx(\"div\", null, __jsx(\"div\", {\n      style: {\n        float: \"right\"\n      }\n    }, __jsx(\"button\", {\n      onClick: () => {\n        router.push(\"/companys\");\n      },\n      class: \"btn btn-icon btn-primary\",\n      type: \"button\"\n    }, __jsx(\"span\", {\n      class: \"btn-inner--icon\"\n    }, __jsx(\"i\", {\n      class: \"fa fa-arrow-right\",\n      \"aria-hidden\": \"true\"\n    }))), __jsx(\"h2\", {\n      style: {\n        marginRight: \"0.8em\",\n        display: \"inline\"\n      }\n    }, \"\\u0627\\u062E\\u062A\\u0631 \\u0627\\u0644\\u0641\\u0631\\u0639 :\"), __jsx(\"div\", {\n      style: {\n        clear: \"both\"\n      }\n    })), __jsx(\"div\", {\n      style: {\n        clear: \"both\"\n      }\n    }), __jsx(\"div\", {\n      class: \"col-xl-12 col-md-12\",\n      style: {\n        height: \"50px\"\n      }\n    }), results.map((branch, index) => {\n      if (branch.city == localStorage.CurrentCity) {\n        return __jsx(React.Fragment, null, __jsx(\"div\", {\n          class: \"col-xl-3 col-md-6\"\n        }, __jsx(\"div\", {\n          class: \"card card-stats\"\n        }, __jsx(\"div\", {\n          class: \"btn btn-icon \",\n          style: {\n            float: \"left\",\n            zIndex: 9999999999,\n            position: \"absolute\",\n            left: 0,\n            top: 17\n          },\n          onClick: () => {\n            setedit(true);\n            setnewCompany(true);\n            setChoose(\"branches\");\n            setBranch(branch);\n            setBranchname(\" > \" + branch.branch_name);\n            setcompname(branch.company_name); // event.stopPropagation();\n          }\n        }, __jsx(\"img\", {\n          width: \"20\",\n          src: \"https://image.flaticon.com/icons/png/512/84/84380.png\"\n        })), __jsx(\"div\", {\n          class: \"card-body\",\n          onClick: () => {\n            console.log(index);\n            setBranch_id(branch.id);\n            setBracnhCode(branch.BracnhCode);\n            setChoose(\"coubons\");\n            setBranchname(\" > \" + branch.branch_name);\n            setcompname(branch.company_name); // setCompany(comp.branches);\n          }\n        }, __jsx(\"div\", {\n          class: \"row\"\n        }, __jsx(\"div\", {\n          class: \"col-12\"\n        }, __jsx(\"div\", {\n          class: \"icon icon-shape bg-gradient-primary text-white rounded-circle shadow\"\n        }, __jsx(\"i\", {\n          class: \"ni ni-shop\"\n        }))), __jsx(\"div\", {\n          class: \"col-12\"\n        }, __jsx(\"span\", {\n          class: \"h2 font-weight-bold mb-0\"\n        }, branch.branch_name), __jsx(\"h5\", {\n          class: \"card-title text-uppercase text-muted mb-0\"\n        }, branch.ShortDesc)))))));\n      } else {\n        localStorage.CurrentCity = branch.city;\n        return __jsx(React.Fragment, null, __jsx(\"div\", {\n          class: \"col-xl-12 col-md-12\",\n          style: {\n            height: \"50px\"\n          }\n        }, \" \", __jsx(\"h1\", null, branch.city)), __jsx(\"div\", {\n          class: \"col-xl-3 col-md-6\"\n        }, __jsx(\"div\", {\n          class: \"card card-stats\"\n        }, __jsx(\"div\", {\n          class: \"btn btn-icon \",\n          style: {\n            float: \"left\",\n            zIndex: 9999999999,\n            position: \"absolute\",\n            left: 0,\n            top: 17\n          },\n          onClick: () => {\n            console.log(\"hedddddddddddddddddddddddddre\");\n            setedit(true);\n            setnewCompany(true);\n            setChoose(\"branches\");\n            setBranch(branch);\n            setBranchname(\" > \" + branch.branch_name);\n            setcompname(branch.company_name); // event.stopPropagation();\n          }\n        }, __jsx(\"img\", {\n          width: \"20\",\n          src: \"https://image.flaticon.com/icons/png/512/84/84380.png\"\n        })), __jsx(\"div\", {\n          class: \"card-body\",\n          onClick: () => {\n            setBranch_id(branch.id);\n            setBracnhCode(branch.BracnhCode);\n            setChoose(\"coubons\");\n            setBranchname(\" > \" + branch.branch_name);\n            setcompname(branch.company_name);\n          }\n        }, __jsx(\"div\", {\n          class: \"btn btn-icon \",\n          style: {\n            float: \"left\",\n            zIndex: 99999999,\n            opacity: 0\n          }\n        }, __jsx(\"img\", {\n          width: \"20\",\n          src: \"https://image.flaticon.com/icons/png/512/84/84380.png\"\n        })), __jsx(\"div\", {\n          class: \"row\"\n        }, __jsx(\"div\", {\n          class: \"col-12\"\n        }, __jsx(\"div\", {\n          class: \"icon icon-shape bg-gradient-primary text-white rounded-circle shadow\"\n        }, __jsx(\"i\", {\n          class: \"ni ni-shop\"\n        }))), __jsx(\"div\", {\n          class: \"col-12\"\n        }, __jsx(\"span\", {\n          class: \"h2 font-weight-bold mb-0\"\n        }, branch.branch_name), __jsx(\"h5\", {\n          class: \"card-title text-uppercase text-muted mb-0\"\n        }, branch.ShortDesc)))))));\n      }\n    }), \" \") : choose == \"coubons\" ? __jsx(BranchCoubonTable, {\n      branch_id: branch_id,\n      companyName: name,\n      setChoose: changeChoose\n    }) : \"\");\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"body\", {\n    className: \"rtl g-sidenav-show g-sidenav-pinned\",\n    dir: \"rtl\"\n  }, __jsx(\"div\", null, toggler ? __jsx(Admin_nav, null) : \"\", __jsx(\"div\", {\n    className: \"main-content\",\n    id: \"panel\"\n  }, __jsx(HeaderNav, null), __jsx(\"div\", {\n    className: \"container-fluid mt--6\"\n  }, choose == \"coubons\" ? __jsx(React.Fragment, null, __jsx(\"h1\", null, \"strokeDashoffset\"), __jsx(BranchCoubonTable, {\n    branch_id: branch_id,\n    BracnhCode: BracnhCode,\n    companyName: compname,\n    Branchname: Branchname,\n    setChoose: changeChoose,\n    listOfBranches: results\n  })) : __jsx(\"div\", {\n    className: \"row justify-content-center\"\n  }, __jsx(\"div\", {\n    className: \" col \"\n  }, __jsx(\"div\", {\n    className: \"card\"\n  }, __jsx(\"div\", {\n    className: \"card-header bg-transparent\"\n  }, __jsx(\"h3\", {\n    className: \"mb-0\"\n  }, \"\\u0641\\u0631\\u0648\\u0639 \\u0627\\u0644\\u0634\\u0631\\u0643\\u0629\"), __jsx(\"div\", {\n    style: {\n      float: \"left\"\n    }\n  }, __jsx(\"button\", {\n    onClick: () => {\n      setnewCompany(true); // setChoose(\"branches\");\n    },\n    class: \"btn btn-icon btn-danger\",\n    type: \"button\"\n  }, __jsx(\"span\", {\n    class: \"btn-inner--icon\"\n  }, \"\\u0625\\u0646\\u0634\\u0627\\u0621 \", choose == \"branches\" ? \"فرع\" : \"كوبون\", \" \", \"\\u062C\\u062F\\u064A\\u062F\")))), newCompany == false ? __jsx(\"div\", {\n    className: \"card-body\"\n  }, results ? results == \"No_data\" ? __jsx(\"div\", {\n    style: {\n      float: \"right\"\n    }\n  }, __jsx(\"button\", {\n    onClick: () => {\n      router.push(\"/companys\");\n    },\n    class: \"btn btn-icon btn-primary\",\n    type: \"button\"\n  }, __jsx(\"span\", {\n    class: \"btn-inner--icon\"\n  }, __jsx(\"i\", {\n    class: \"fa fa-arrow-right\",\n    \"aria-hidden\": \"true\"\n  }))), __jsx(\"h2\", {\n    style: {\n      marginRight: \"0.8em\",\n      display: \"inline\"\n    }\n  }, \"\\u0627\\u062E\\u062A\\u0631 \\u0627\\u0644\\u0641\\u0631\\u0639 :\"), __jsx(\"div\", {\n    style: {\n      clear: \"both\"\n    }\n  }), __jsx(\"h2\", {\n    style: {\n      marginTop: \"0.8em\"\n    }\n  }, \"\\u0644\\u0627 \\u064A\\u0648\\u062C\\u062F \\u0628\\u064A\\u0627\\u0646\\u0627\\u062A\")) : displayCards(results) : \"\", showSkeleton ? __jsx(Skeleton, {\n    height: 40,\n    count: 10\n  }) : \"\") : __jsx(\"div\", {\n    className: \"card-body\"\n  }, \" \", choose == \"branches\" ? edit == false ? __jsx(NewBranchForm, {\n    company_id: results[0].company_id,\n    GoBackAndTriggerMutation: GoBackAndTriggerMutation,\n    changenewCompany: changenewCompany,\n    companyName: results[0].company_name\n  }) : __jsx(EditBranchForm, {\n    company_id: results[0].company_id,\n    GoBackAndTriggerMutation: GoBackAndTriggerMutation,\n    companyName: compname,\n    Branchname: Branchname,\n    changenewCompany: changenewCompany,\n    branch: Branch\n  }) : \"\")))), __jsx(Footer, null))))));\n}\n\nexport default ProtectRoute(company);","map":null,"metadata":{},"sourceType":"module"}