{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport Admin_nav from \"../components/Admin_nav\";\nimport React, { useState, useEffect } from \"react\";\nimport HeaderNav from \"../components/HeaderNav\";\nimport PersonNeeds from \"../components/PersonNeeds\";\nimport api from \"../services/Api\";\nimport EditableImage from \"../Components/editable-image/EditableImage\";\nimport ButtonUploadImage from \"../Components/button-upload/ButtonUpload\";\nimport axios from \"axios\";\nimport Footer from \"../components/Footer\";\nimport { GetC } from \"../services/api_get\";\nimport useAuth, { ProtectRoute } from \"../contexts/auth.js\";\nimport { useAlert } from \"react-alert\";\nimport Cookies from \"js-cookie\";\n\nfunction Table() {\n  var token = Cookies.get(\"token\");\n  var siteUrl = Cookies.get(\"siteUrl\");\n\n  var _useState = useState(),\n      ProductImage = _useState[0],\n      setProductImage = _useState[1];\n\n  var alert = useAlert(); //const [project,setProject] = useState(false);\n\n  var _useAuth = useAuth(),\n      toggler = _useAuth.toggler,\n      settoggler = _useAuth.settoggler,\n      loading = _useAuth.loading;\n\n  var _useState2 = useState(false),\n      spinner = _useState2[0],\n      setspinner = _useState2[1];\n\n  var _GetC = GetC(),\n      data = _GetC.data,\n      isLoading = _GetC.isLoading,\n      isError = _GetC.isError;\n\n  var results = isLoading ? false : data.data;\n  console.log(results);\n  var showSkeleton = isLoading || loading;\n\n  var _useState3 = useState(true),\n      firstTime = _useState3[0],\n      setfirstTime = _useState3[1];\n\n  var _useState4 = useState([]),\n      categories = _useState4[0],\n      setcategories = _useState4[1];\n\n  var _useState5 = useState([]),\n      registerResults = _useState5[0],\n      setregisterResults = _useState5[1];\n\n  if (firstTime && results) {\n    setcategories(results.options.categories);\n    setfirstTime(false);\n  }\n\n  var _useState6 = useState(\"\"),\n      XML = _useState6[0],\n      setXML = _useState6[1];\n\n  var _useState7 = useState(1),\n      step = _useState7[0],\n      setStep = _useState7[1];\n\n  var _useState8 = useState(0),\n      step2 = _useState8[0],\n      setStep2 = _useState8[1];\n\n  var _useState9 = useState([]),\n      list = _useState9[0],\n      updateList = _useState9[1];\n\n  var _useState10 = useState(false),\n      allowed = _useState10[0],\n      setallowed = _useState10[1];\n\n  function updateArray(data) {\n    var favorite = list;\n    favorite.push(data);\n    updateList(favorite);\n    setallowed(true); //  setPersonNeeds((PersonNeeds) => PersonNeeds.concat(data));\n    // setPersonNeeds((PersonNeeds) => [...PersonNeeds, data]);\n  }\n\n  function handleThumbnailProduct(file) {\n    var imageObj = {\n      id: file.name,\n      name: file.name,\n      isUloading: true,\n      imageObject: file\n    };\n    console.log(imageObj);\n    setProductImage(imageObj);\n    var formData = new FormData();\n    formData.append(\"file\", file);\n    axios.post(siteUrl + \"wp/v2/media\", formData, {\n      headers: {\n        Authorization: \"Bearer \".concat(token)\n      }\n    }).then(function (result) {\n      console.log(result.data.source_url);\n      setXML(result.data.source_url);\n    });\n  }\n\n  function removeUser(_x) {\n    return _removeUser.apply(this, arguments);\n  }\n\n  function _removeUser() {\n    _removeUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(id) {\n      var favorite;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              favorite = list;\n\n              if (list.length == 1) {\n                setallowed(false);\n              }\n\n              _context.next = 4;\n              return favorite.filter(function (e) {\n                return e.id !== id;\n              });\n\n            case 4:\n              favorite = _context.sent;\n              updateList(favorite);\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _removeUser.apply(this, arguments);\n  }\n\n  function mysubmit() {\n    var data = {\n      XML: XML,\n      categories: list\n    };\n    var checke = true;\n    console.log(data);\n\n    if (data.XML == \"\") {\n      checke = false;\n      alert.show(\"الرجاء رفع الملف \", {\n        timeout: 2000,\n        type: \"error\"\n      });\n    }\n\n    if (data.categories.length == 0) {\n      checke = false;\n      alert.show(\"الرجاء إختيار إحتياج واحد أو أكثر \", {\n        timeout: 2000,\n        type: \"error\"\n      });\n    }\n\n    setspinner(true);\n\n    if (checke) {\n      api.post(\"rabwa/CreatNewUserXml\", data).then(function (res) {\n        setspinner(false);\n        console.log(res.data);\n\n        if (res.data == \"already exists\") {\n          alert.show(\"إسم الكوبون موجود مسبقا \", {\n            timeout: 2000,\n            type: \"error\"\n          });\n        }\n\n        if (res.data == \"phone\") {\n          alert.show(\"رقم الجوال مستخدم مسبقا\", {\n            timeout: 2000,\n            type: \"error\"\n          });\n        }\n\n        if (res.data == \"email\") {\n          alert.show(\"الإيميل مستخدم مسبقا\", {\n            timeout: 2000,\n            type: \"error\"\n          });\n        }\n\n        if (res.data.length > 0) {\n          setregisterResults(res.data);\n          setStep2(3);\n          alert.show(\"تم بنجاح\", {\n            timeout: 2000,\n            type: \"success\"\n          }); //GoBackAndTriggerMutation();\n          //router.push(\"/companys/[name]\", \"/companys/\" + formdata.companyName);\n        } //console.log(res.data);\n\n      })[\"catch\"](function (err) {\n        alert.show(\"حصل خطأ\", {\n          timeout: 2000,\n          type: \"error\"\n        });\n        setspinner(false);\n        console.log(err);\n      });\n    }\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"body\", {\n    className: \"rtl g-sidenav-show g-sidenav-pinned\",\n    dir: \"rtl\"\n  }, __jsx(\"div\", null, __jsx(Admin_nav, null), __jsx(\"div\", {\n    \"class\": \"main-content\",\n    id: \"panel\"\n  }, __jsx(HeaderNav, null), __jsx(\"div\", {\n    \"class\": \"container-fluid mt--6\"\n  }, __jsx(\"div\", {\n    \"class\": \"row justify-content-center\"\n  }, __jsx(\"div\", {\n    \"class\": \" col \"\n  }, __jsx(\"div\", {\n    \"class\": \"card\"\n  }, __jsx(\"div\", {\n    \"class\": \"card-header bg-transparent\"\n  }, __jsx(\"h3\", {\n    \"class\": \"mb-0\"\n  }, \"\\u062A\\u0633\\u062C\\u064A\\u0644 \\u0645\\u062C\\u0645\\u0648\\u0639\\u0629 \\u0645\\u0633\\u062A\\u0641\\u064A\\u062F\\u064A\\u0646\")), __jsx(\"div\", {\n    \"class\": \"card-body\"\n  }, step == 1 ? __jsx(\"div\", null, \" \", __jsx(\"h6\", {\n    className: \"heading-small text-muted mb-4\"\n  }, \"\\u0631\\u0641\\u0639 \\u0627\\u0644\\u0645\\u0644\\u0641\"), __jsx(\"div\", {\n    className: \"pl-lg-4\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, __jsx(\"div\", {\n    style: {\n      width: \"140px\",\n      margin: \"2em auto\"\n    }\n  }, ProductImage ? __jsx(EditableImage, {\n    imageObject: ProductImage,\n    removeImageFunc: function removeImageFunc() {\n      return setProductImage(false);\n    }\n  }) : __jsx(ButtonUploadImage, {\n    typeImage: \"thumbnail\",\n    onChange: function onChange(thumbnail) {\n      return handleThumbnailProduct(thumbnail.target.files[0]);\n    }\n  })))))) : \"\", step == 2 ? step2 == 0 ? __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"table-responsive\"\n  }, __jsx(\"div\", null, __jsx(\"table\", {\n    className: \"table align-items-center\"\n  }, __jsx(\"thead\", {\n    className: \"thead-light\"\n  }, __jsx(\"tr\", null, __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"name\"\n  }, \"\\u0627\\u0644\\u0625\\u062D\\u062A\\u064A\\u0627\\u062C\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0627\\u062E\\u062A\\u064A\\u0627\\u0631\"))), __jsx(\"tbody\", {\n    className: \"list\"\n  }, categories.length > 0 ? categories.map(function (data, i) {\n    return __jsx(PersonNeeds, {\n      data: data,\n      updateArray: updateArray,\n      removeUser: removeUser\n    });\n  }) : \"\"))))) : __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"table-responsive\"\n  }, __jsx(\"div\", null, __jsx(\"table\", {\n    className: \"table align-items-center\"\n  }, __jsx(\"thead\", {\n    className: \"thead-light\"\n  }, __jsx(\"tr\", null, __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"name\"\n  }, \"\\u0627\\u0644\\u0625\\u0633\\u0645\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0627\\u0644\\u0625\\u064A\\u0645\\u064A\\u0644\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0631\\u0642\\u0645 \\u0627\\u0644\\u062C\\u0648\\u0627\\u0644\"), __jsx(\"th\", {\n    scope: \"col\",\n    className: \"sort\",\n    \"data-sort\": \"budget\"\n  }, \"\\u0627\\u0644\\u062D\\u0627\\u0644\\u0629\"))), __jsx(\"tbody\", {\n    className: \"list\"\n  }, registerResults.length > 0 ? registerResults.map(function (data, i) {\n    return __jsx(\"tr\", null, __jsx(\"td\", {\n      className: \"budget\"\n    }, data.FirstName[0] + \" \" + data.LastName[0]), __jsx(\"td\", {\n      className: \"budget\"\n    }, data.Email[0]), __jsx(\"td\", {\n      className: \"budget\"\n    }, data.Phone[0]), __jsx(\"td\", {\n      className: \"budget\"\n    }, data.res == \"phone\" ? __jsx(\"p\", {\n      style: {\n        color: \"red\"\n      }\n    }, \"\\u0631\\u0642\\u0645 \\u0627\\u0644\\u062C\\u0648\\u0627\\u0644 \\u0645\\u0633\\u062A\\u062E\\u062F\\u0645 \\u0645\\u0633\\u0628\\u0642\\u0627\") : data.res == \"email\" ? __jsx(\"p\", {\n      style: {\n        color: \"red\"\n      }\n    }, \"\\u0627\\u0644\\u0625\\u064A\\u0645\\u064A\\u0644 \\u0645\\u0633\\u062A\\u062E\\u062F\\u0645 \\u0645\\u0633\\u0628\\u0642\\u0627\", \" \") : data.res ? __jsx(\"p\", {\n      style: {\n        color: \"green\"\n      }\n    }, \"\\u062A\\u0645 \\u0628\\u0646\\u062C\\u0627\\u062D\", \" \") : \"\"));\n  }) : \"\"))))) : \"\", __jsx(\"div\", null, __jsx(\"div\", {\n    style: {\n      margin: \"0 auto\",\n      textAlign: \"center\",\n      marginTop: \"9em\"\n    }\n  }, step == 1 ? \"\" : step2 == 0 ? __jsx(\"button\", {\n    type: \"button\",\n    \"class\": \"btn btn-lg btn-primary\",\n    disabled: step == 1 ? true : false,\n    onClick: function onClick() {\n      step == 1 ? false : setStep(step - 1);\n    }\n  }, \"\\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\") : \"\", \"     \", step == 2 ? \"\" : __jsx(\"button\", {\n    type: \"button\",\n    \"class\": \"btn btn-lg btn-primary\",\n    disabled: step == 2 ? true : false,\n    onClick: function onClick() {\n      step == 2 ? false : setStep(step + 1);\n    }\n  }, \"\\u0627\\u0644\\u062A\\u0627\\u0644\\u064A\"))), step == 2 ? step2 == 0 ? __jsx(\"div\", null, __jsx(\"hr\", null), __jsx(\"div\", {\n    style: {\n      textAlign: \"left\"\n    }\n  }, __jsx(\"button\", {\n    \"class\": \"btn btn-icon btn-success\",\n    onClick: function onClick() {\n      mysubmit();\n    },\n    type: \"button\"\n  }, __jsx(\"span\", {\n    style: {\n      marginLeft: \".75em\",\n      marginRight: \"auto\"\n    },\n    \"class\": \"btn-inner--text\"\n  }, \"\\u0625\\u0646\\u0634\\u0627\\u0621\"), \"     \", __jsx(\"span\", {\n    \"class\": \"btn-inner--icon\"\n  }, __jsx(\"i\", {\n    \"class\": \"ni ni-send\"\n  }))))) : \"\" : \"\")))), __jsx(Footer, null))))));\n}\n\nexport default ProtectRoute(Table);","map":null,"metadata":{},"sourceType":"module"}