{"ast":null,"code":"var __jsx = React.createElement;\nimport Admin_nav from \"../components/Admin_nav\";\nimport React, { useState, useEffect } from \"react\";\nimport HeaderNav from \"../components/HeaderNav\";\nimport api from \"../services/Api\";\nimport Footer from \"../components/Footer\";\nimport useAuth, { ProtectRoute } from \"../contexts/auth.js\";\nimport { useAlert } from \"react-alert\"; //import EditableImage2 from \"./editable-image/EditableImage2\";\n//import ButtonUploadImage from \"./button-upload/ButtonUpload\";\n\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\nimport { useRouter } from \"next/router\"; // react plugin used to create charts\n//import \"chartjs-top-round-bar\";\n\nfunction UpdateProfileForm() {\n  const {\n    0: first_name,\n    1: setfirst_name\n  } = useState(Cookies.get(\"first_name\"));\n  const {\n    0: last_name,\n    1: setlast_name\n  } = useState(Cookies.get(\"last_name\"));\n  const {\n    0: profile_pic,\n    1: setprofile_pic\n  } = useState(false);\n  const alert = useAlert();\n  const router = useRouter();\n  const token = Cookies.get(\"token\");\n  const siteUrl = Cookies.get(\"siteUrl\");\n  const {\n    0: XML,\n    1: setXML\n  } = useState(false);\n  const {\n    toggler,\n    settoggler,\n    loading\n  } = useAuth();\n  const {\n    0: spinner,\n    1: setspinner\n  } = useState(false);\n  /*\r\n  const { data, isLoading, isError } = GetCategories();\r\n    const results = isLoading ? false : data.data;\r\n  const showSkeleton = isLoading || loading;\r\n  */\n\n  function handleThumbnailProduct(file) {\n    let imageObj = {\n      id: file.name,\n      name: file.name,\n      isUloading: true,\n      imageObject: file\n    };\n    console.log(imageObj);\n    setprofile_pic(imageObj);\n    let formData = new FormData();\n    formData.append(\"file\", file);\n    axios.post(siteUrl + \"wp/v2/media\", formData, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(result => {\n      console.log(result.data.source_url);\n      setXML(result.data.source_url);\n    });\n  }\n\n  const onSubmit = () => {\n    let formdata = {\n      first_name,\n      last_name,\n      profile_pic: XML\n    };\n    setspinner(true);\n    console.log(formdata);\n    api.post(\"rabwa/UpdateUserProfile\", formdata).then(res => {\n      console.log(res.data);\n      setspinner(false);\n\n      if (res.data > 0) {\n        alert.show(\"تم بنجاح\", {\n          timeout: 2000,\n          type: \"success\"\n        });\n\n        if (XML) {\n          Cookies.set(\"profile_pic\", XML, {\n            expires: 60\n          });\n        }\n\n        Cookies.set(\"first_name\", first_name, {\n          expires: 60\n        });\n        Cookies.set(\"last_name\", last_name, {\n          expires: 60\n        });\n\n        if (Cookies.get(\"UserType\") == \"admin\") {\n          router.push(\"/UpdateProfileA\");\n        } else if (Cookies.get(\"UserType\") == \"mandobe\") {\n          router.push(\"/UpdateProfileM\");\n        } else if (Cookies.get(\"UserType\") == \"Company\") {\n          router.push(\"/UpdateProfileC\");\n        }\n      }\n    }).catch(err => {\n      console.log(err);\n      setspinner(false);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"body\", {\n    className: \"rtl g-sidenav-show g-sidenav-pinned\",\n    dir: \"rtl\"\n  }, __jsx(\"div\", null, toggler ? __jsx(Admin_nav, null) : \"\", __jsx(\"div\", {\n    className: \"main-content\",\n    id: \"panel\"\n  }, __jsx(HeaderNav, null), __jsx(\"div\", {\n    className: \"container-fluid mt--6\"\n  }, __jsx(\"div\", {\n    className: \"row justify-content-center\"\n  }, __jsx(\"div\", {\n    className: \" col \"\n  }, __jsx(\"div\", {\n    className: \"card\"\n  }, __jsx(\"div\", {\n    className: \"card-header bg-transparent\"\n  }, __jsx(\"h3\", {\n    className: \"mb-0\"\n  }, \"\\u062A\\u0639\\u062F\\u064A\\u0644 \\u0627\\u0644\\u0645\\u0644\\u0641 \\u0627\\u0644\\u0634\\u062E\\u0635\\u064A\")), __jsx(\"div\", {\n    className: \"card-body\"\n  }, __jsx(\"div\", null, __jsx(\"div\", {\n    dir: \"rtl\",\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", {\n    className: \"form-control-label\"\n  }, \"\\u0627\\u0644\\u0625\\u0633\\u0645 \\u0627\\u0644\\u0623\\u0648\\u0644\"), __jsx(\"input\", {\n    type: \"text\",\n    name: \"first_name\",\n    onChange: e => {\n      setfirst_name(e.target.value);\n    },\n    value: first_name,\n    className: \"form-control\",\n    placeholder: \"\\u0627\\u0644\\u0625\\u0633\\u0645 \\u0627\\u0644\\u0623\\u0648\\u0644\"\n  }))), __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", {\n    className: \"form-control-label\"\n  }, \"\\u0627\\u0644\\u0625\\u0633\\u0645 \\u0627\\u0644\\u0625\\u062E\\u064A\\u0631\"), __jsx(\"input\", {\n    type: \"text\",\n    name: \"last_name\",\n    onChange: e => {\n      setlast_name(e.target.value);\n    },\n    value: last_name,\n    className: \"form-control\",\n    placeholder: \"\\u0627\\u0644\\u0625\\u0633\\u0645 \\u0627\\u0644\\u0625\\u062E\\u064A\\u0631\"\n  }))), __jsx(\"div\", {\n    className: \"col-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", {\n    style: {\n      float: \"right\"\n    },\n    className: \"form-control-label\"\n  }, \"\\u0635\\u0648\\u0631\\u0629 \\u0627\\u0644\\u0645\\u0644\\u0641 \\u0627\\u0644\\u0634\\u062E\\u0635\\u064A\"), __jsx(\"div\", {\n    style: {\n      width: \"140px\",\n      margin: \"2em auto\"\n    }\n  }, profile_pic ? \"\" : \"\")))), spinner ? __jsx(\"button\", {\n    className: \"btn btn-default\",\n    disabled: true,\n    style: {\n      float: \"left\"\n    }\n  }, __jsx(\"span\", {\n    className: \"spinner-grow spinner-grow-sm\"\n  }), \"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u0625\\u0631\\u0633\\u0627\\u0644 ..\") : __jsx(\"button\", {\n    style: {\n      float: \"left\"\n    },\n    type: \"submit\",\n    className: \"btn btn-default\",\n    onClick: () => {\n      onSubmit();\n    }\n  }, \"\\u0625\\u0631\\u0633\\u0627\\u0644\")))))), __jsx(Footer, null))))));\n}\n\nexport default UpdateProfileForm;","map":null,"metadata":{},"sourceType":"module"}